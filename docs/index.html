<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link rel="canonical" href="https://nba-ai.us/" />
    <title>NBA AI</title>
    <meta
      name="description"
      content="Using AI to predict the outcomes of NBA games."
    />

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Jekyll v3.9.3" />
    <meta property="og:title" content="NBA AI" />
    <meta property="og:locale" content="en_US" />
    <meta
      property="og:description"
      content="Using AI to predict the outcomes of NBA games."
    />
    <meta property="og:url" content="https://nba-ai.us/" />
    <meta property="og:site_name" content="NBA AI" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="NBA AI" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "description": "Using AI to predict the outcomes of NBA games.",
        "headline": "NBA AI",
        "name": "NBA AI",
        "url": "https://nba-ai.us/"
      }
    </script>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />

    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-5FNXVFZDEQ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-5FNXVFZDEQ");
    </script>

    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="images/bball_favicon.png"
    />
  </head>

  <body id="top">
    <!-- Header -->
    <nav
      class="navbar navbar-expand-md navbar-light bg-white fixed-top shadow-sm"
    >
      <div
        class="container-md d-flex justify-content-between align-items-center"
      >
        <a class="navbar-brand d-flex align-items-center" href="#top">
          <!-- Use Bootstrap's width utilities to control image size responsively -->
          <img
            src="images/nba_ai_logo.png"
            alt="Logo"
            class="d-inline-block align-middle"
            style="height: 2rem; width: auto"
          />
          <span
            class="h1 mb-0 ms-2 align-middle"
            style="line-height: 1; font-size: 2rem"
            >NBA AI</span
          >
        </a>
        <div class="github-branding">
          <a
            href="https://github.com/NBA-Betting/NBA_AI"
            target="_blank"
            rel="noopener noreferrer"
            class="d-flex align-items-center text-dark text-decoration-none"
          >
            <img
              src="images/GitHub_Logo.png"
              alt="GitHub Name"
              class="img-fluid me-2"
              style="height: 2rem; width: auto"
            />
            <img
              src="images/github-mark.png"
              alt="GitHub Icon"
              class="img-fluid"
              style="height: 2rem; width: auto"
            />
          </a>
        </div>
      </div>
    </nav>

    <!-- Content -->
    <div class="container-md body-content">
      <!-- Header Image -->
      <div class="container-md">
        <img
          src="images/nba_ai_header_15x6.png"
          alt="Header Image"
          class="img-fluid"
          style="width: 100%; height: auto"
        />
      </div>

      <!-- Table of Contents -->
      <div class="container-md my-4">
        <h2 id="table-of-contents">Table of Contents</h2>
        <div class="list-group">
          <a
            class="list-group-item list-group-item-action"
            href="#project-overview"
            ><strong>Project Overview</strong></a
          >
          <div class="list-group list-group-flush ml-3">
            <a
              class="list-group-item list-group-item-action"
              href="#current-state"
              >• Current State</a
            >
            <a
              class="list-group-item list-group-item-action"
              href="#future-goals"
              >• Future Goals</a
            >
            <a
              class="list-group-item list-group-item-action"
              href="#guiding-principles"
              >• Guiding Principles</a
            >
          </div>
          <a class="list-group-item list-group-item-action" href="#web-app"
            ><strong>Web App</strong></a
          >
          <a
            class="list-group-item list-group-item-action"
            href="#prediction-engines"
            ><strong>Prediction Engines</strong></a
          >
          <a
            class="list-group-item list-group-item-action"
            href="#quick-start"
            ><strong>Quick Start</strong></a
          >
          <a
            class="list-group-item list-group-item-action"
            href="#development-status"
            ><strong>Development Status</strong></a
          >
        </div>
      </div>

      <!-- Project Overview -->
      <div class="container my-5">
        <h1 id="project-overview">Project Overview</h1>

        <p id="project-goal" class="lead">
          Using AI to predict the outcomes of NBA games.
        </p>

        <p>
          This project aims to streamline the process of predicting NBA game
          outcomes by focusing on advanced AI prediction models rather than
          extensive data collection and management. Unlike my previous project,
          <a
            href="https://github.com/NBA-Betting/NBA_Betting/tree/main"
            target="_blank"
            rel="noopener noreferrer"
            >NBA Betting</a
          >, which aimed to create a comprehensive feature set for predicting
          NBA games through extensive data collection, this project simplifies
          the process. While the previous approach benefited from various
          industry-derived metrics, the cost and complexity of managing the data
          collection were too high. This project focuses on a core data set,
          such as play-by-play data, and leverages deep learning and GenAI to
          predict game outcomes.
        </p>

        <h2 id="current-state">Current State</h2>

        <p>
          The project is in active development with a complete data collection
          pipeline and basic prediction engines. Recent infrastructure cleanup removed unnecessary complexity (Airflow orchestration, Wandb experiment tracking) to focus on the core GenAI prediction engine development.
        </p>

        <p>
          The current system supports seasons 2023-2026 with complete PBP → GameStates → PlayerBox/TeamBox → Features → Predictions pipeline. The default installation includes only the current season (2025-2026); historical data is available separately. The web app provides a simple interface for displaying games with current scores and predictions.
        </p>

        <img
          src="images/project_flowchart.png"
          alt="Project Flowchart"
          class="img-fluid custom-image mx-auto"
        />

        <p>The project is built around a few key components:</p>
        <ul>
          <li>
            <strong>Database Updater</strong>: This component is responsible for
            updating the database with the latest NBA game data. It fetches data
            from the NBA Stats API, performs ETL operations, generates features,
            creates predictions, and stores the data in a SQLite database. It
            consists of a few modules:
            <ul>
              <li>
                <code>database_update_manager.py</code>: The main module that
                orchestrates the entire process.
              </li>
              <li>
                <code>schedule.py</code>: Fetches the schedule from the NBA API
                and updates the database.
              </li>
              <li>
                <code>players.py</code>: Fetches and updates player reference data.
              </li>
              <li>
                <code>nba_official_injuries.py</code>: Fetches injury reports from NBA's official injury report PDFs.
              </li>
              <li>
                <code>betting.py</code>: Fetches betting lines (spreads/totals) from ESPN API and Covers.com.
              </li>
              <li>
                <code>pbp.py</code>: Fetches play-by-play data for games and
                updates the database.
              </li>
              <li>
                <code>game_states.py</code>: Parses play-by-play data to
                generate game states and updates the database.
              </li>
              <li>
                <code>boxscores.py</code>: Fetches traditional boxscore stats (PlayerBox and TeamBox).
              </li>
              <li>
                <code>prior_states.py</code>: Determines prior final game states
                for teams.
              </li>
              <li>
                <code>features.py</code>: Uses prior final game states to
                generate features for the prediction engine.
              </li>
              <li>
                <code>prediction_manager.py</code>: Generates predictions for
                games using the chosen prediction engine.
              </li>
            </ul>
          </li>
          <li>
            <strong>Games API</strong>: This component is responsible for
            updating predictions for ongoing or completed games and providing
            the data to the web app. It fetches data from the database,
            generates predictions, and serves the data to the web app.
            <ul>
              <li>
                <code>games.py</code>: Fetches game data from the database,
                manages prediction updating and data formatting.
              </li>
              <li><code>api.py</code>: Defines the API endpoints.</li>
            </ul>
          </li>
          <li>
            <strong>Web App</strong>: This component is the front end of the
            project, providing a simple interface for users to view games and
            predictions. It is built using Flask.
            <ul>
              <li>
                <code>start_app.py</code>: The main entry point for the web app
                found in the root directory.
              </li>
              <li>
                <code>app.py</code>: The main module that defines the Flask app
                and routes.
              </li>
              <li>
                <code>game_data_processor.py</code>: Formats game data from the
                API for the web app.
              </li>
              <li>
                <code>templates/</code>: Contains the HTML templates for the web
                app.
              </li>
              <li>
                <code>static/</code>: Contains the CSS and JavaScript files for
                the web app.
              </li>
            </ul>
          </li>
        </ul>

        <h2 id="future-goals">Future Goals</h2>

        <img
          src="images/foundational_model_outline.png"
          alt="Foundational Model Outline"
          class="img-fluid custom-image mx-auto"
        />

        <ol>
          <li>
            <strong>Data Sourcing</strong>: Focus on a minimal number of data
            sources that fundamentally describe basketball. Currently, we use
            play-by-play data from the NBA API. In the future, incorporating
            video and tracking data would be interesting, though these require
            considerably more resources and access.
          </li>
          <li>
            <strong>Prediction Engine</strong>: This is the core of the project
            and the current development focus. The current prediction engine
            options will be replaced with a DL and GenAI-based engine, allowing
            for decreased data parsing and feature engineering while also
            scaling to predict more complex outcomes, including individual
            player performance.
          </li>
          <li>
            <strong>Data Storage</strong>: Future data storage will more
            seamlessly integrate with the prediction engine. The storage
            requirements will combine the current SQL-based data used for the
            API and web app with more advanced vector-based storage for
            RAG-based GenAI models.
          </li>
          <li>
            <strong>Web App</strong>: This is the project's front end,
            displaying the games for the selected date along with current scores
            and predictions. The interface will remain simple while usability is
            gradually improved. A separate GenAI chat will be added in the
            future to allow users to interact with the prediction engine and
            modify individual predictions based on their preferences.
          </li>
        </ol>

        <h2 id="guiding-principles">Guiding Principles</h2>

        <img
          src="images/guiding_principles.png"
          alt="Project Guiding Principles"
          class="img-fluid custom-image mx-auto"
        />

        <ul>
          <li>
            <strong>Time Series Data Inclusive</strong>: A focus on
            incorporating the sequential nature of events in games and across
            seasons, recognizing the significance of order and timing in the
            NBA.
          </li>
          <li>
            <strong>Minimal Data Collection</strong>: Streamlining data sourcing
            to the essentials, aiming for maximum impact with minimal data,
            thereby reducing time and resource investment.
          </li>
          <li>
            <strong>Wider Applicability</strong>: Extending the scope to cover
            more comprehensive outcomes, moving beyond standard predictions like
            point spreads or over/unders.
          </li>
          <li>
            <strong>Advanced Modeling System</strong>: Developing a system that
            is not only a learning tool but also potentially novel compared to
            the methods used by odds setters.
          </li>
          <li>
            <strong>Minimal Human Decisions</strong>: Reducing the reliance on
            human decision-making to minimize errors and the limitations of
            individual expertise.
          </li>
        </ul>
      </div>

      <!-- Web App -->
      <div class="container my-5">
        <h1 id="web-app">Web App</h1>

        <img
          src="images/web_app_homepage.png"
          alt="Web App Home Page"
          class="img-fluid custom-image mx-auto"
        />
        <img
          src="images/web_app_game_details.png"
          alt="Web App Game Details"
          class="img-fluid custom-image mx-auto"
        />
      </div>

      <!-- Prediction Engines -->
      <div class="container my-5">
        <h1 id="prediction-engines">Prediction Engines</h1>

        <p>
          Currently, there are a few basic prediction engines used to predict
          the outcomes of NBA games. These serve as placeholders for the more
          advanced DL and GenAI engines that will be implemented in the future.
          The current engines make pre-game predictions for home and away scores
          using ML models. These predictions are then used to calculate the win
          percentage and margin for the home team. Updated (after game start)
          predictions are based on a combination of the current game score, time
          remaining, and the pre-game predictions.
        </p>

        <h3 id="current-prediction-engines">Current Prediction Engines</h3>

        <ul>
          <li>
            <strong>Baseline:</strong> A simple predictor that predicts scores
            based on teams' PPG and opponents' PPG.
          </li>
          <li>
            <strong>Linear:</strong> Ridge Regression model using 34 rolling
            average features from prior game states.
          </li>
          <li>
            <strong>Tree:</strong> XGBoost model using the same features as the
            Linear model (default, best performance).
          </li>
          <li>
            <strong>MLP</strong> <em>(optional)</em><strong>:</strong> PyTorch MLP model - requires uncommenting PyTorch in requirements.txt.
          </li>
          <li>
            <strong>Ensemble</strong> <em>(optional)</em><strong>:</strong> Weighted average of Linear (30%), Tree
            (40%), and MLP (30%) - requires PyTorch.
          </li>
        </ul>

        <h3 id="performance-metrics">Performance Metrics</h3>

        <p>
          The current metrics are based on pre-game predictions for the home and
          away team scores, along with downstream metrics such as win percentage
          and margin. These simple predictors currently outperform the baseline
          predictor.
        </p>

        <p>
          In the future, a more challenging baseline based on the Vegas spread
          will be added when the DL and GenAI models are implemented.
        </p>

        <img
          src="images/predictor_performance.png"
          alt="Prediction Engine Performance Metrics"
          class="img-fluid custom-image mx-auto"
        />
      </div>

      <!-- Quick Start -->
      <div class="container my-5">
        <h1 id="quick-start">Quick Start</h1>

        <h3 id="requirements">Requirements</h3>
        <ul>
          <li>Python 3.10+</li>
          <li>~2GB disk space (database + models + dependencies)</li>
        </ul>

        <h3 id="installation">Installation</h3>

        <p>Clone the repository and run the automated setup:</p>

        <pre><code>git clone https://github.com/NBA-Betting/NBA_AI.git
cd NBA_AI
python setup.py</code></pre>

        <p>The setup script will:</p>
        <ol>
          <li>Create a virtual environment</li>
          <li>Install all dependencies</li>
          <li>Download the database and trained models from GitHub Releases</li>
          <li>Create your <code>.env</code> configuration file</li>
          <li>Verify the installation</li>
        </ol>

        <h3 id="running-the-web-app">Running the Web App</h3>

        <pre><code># Activate the virtual environment
source venv/bin/activate

# Start the web app
python start_app.py</code></pre>

        <p>
          Visit <code>http://localhost:5000</code> to view games and
          predictions.
        </p>

        <h3 id="command-line-options">Command Line Options</h3>

        <pre><code># Use a specific predictor
python start_app.py --predictor=Tree

# Enable debug mode
python start_app.py --debug

# Set log level
python start_app.py --log_level=DEBUG</code></pre>

        <p>
          Available predictors: <code>Baseline</code>, <code>Linear</code>,
          <code>Tree</code> (default), <code>MLP</code>*, <code>Ensemble</code>*
        </p>

        <p>
          *Requires PyTorch - uncomment in requirements.txt
        </p>
      </div>

      <!-- Development Status -->
      <div class="container my-5">
        <h1 id="development-status">Development Status</h1>

        <p><strong>This project is in active development.</strong></p>

        <p>
          The core data pipeline and prediction engines are functional. The focus is now on building advanced DL/GenAI prediction engines using play-by-play data.
        </p>

        <h3>Disclaimer</h3>

        <p>
          This is a personal side project provided "as is" with no guarantees of quality, functionality, or ongoing maintenance. I've vibe-coded much of this release and while I'll try to address issues, I can't promise timely responses or fixes.
        </p>

        <p>
          <strong>For production or commercial use</strong>: Consider using <a href="https://sportradar.com/" target="_blank" rel="noopener noreferrer">SportsRadar</a>, the official NBA data partner. Their API would greatly simplify data management compared to scraping the NBA Stats API. I use this approach only because I can't justify the cost for a personal project.
        </p>

        <h3>Historical Data</h3>

        <p>
          The default setup downloads only the current season (2025-2026, ~1,300 games). A development database with 3 seasons (2023-2024 through 2025-2026, ~4,100 games total) is available from <a
            href="https://github.com/NBA-Betting/NBA_AI/releases"
            target="_blank"
            rel="noopener noreferrer"
            >GitHub Releases</a
          >.
        </p>

        <p>To use it:</p>

        <ol>
          <li>Download <code>NBA_AI_dev.zip</code> from the latest release</li>
          <li>Extract to <code>data/NBA_AI_dev.sqlite</code></li>
          <li>Update your <code>.env</code>:</li>
        </ol>

        <pre><code>DATABASE_PATH=data/NBA_AI_dev.sqlite</code></pre>

        <h3>Usage Notes</h3>

        <ul>
          <li>
            <strong>First run for a date</strong>: When viewing a date for the first time, the app fetches data from the NBA API. This initial update may take a few seconds per game. Subsequent views are instant since data is cached in the database.
          </li>
          <li>
            <strong>Season restrictions</strong>: By default, the web app allows seasons 2023-2024 through 2025-2026. To restrict or expand this, modify <code>valid_seasons</code> in
            <code>config.yaml</code>.
          </li>
        </ul>

        <h3>Technical Notes</h3>

        <ul>
          <li>Default focus: 2025-2026 season (current season for public release)</li>
          <li>Database: SQLite with complete pipeline (Schedule → Players → Injuries → Betting → PBP → GameStates → Boxscores → Features → Predictions)</li>
          <li>Built with Python, Flask, SQLite, scikit-learn, XGBoost, and nba_api (PyTorch optional for MLP/Ensemble)</li>
        </ul>
      </div>
    </div>

    <!-- Bootstrap -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script>
      var navbarHeight = document.querySelector(".navbar").offsetHeight;
      document.querySelector(".body-content").style.paddingTop =
        navbarHeight + "px";
    </script>
  </body>
</html>
